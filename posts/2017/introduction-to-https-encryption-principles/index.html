<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content=""/>
  <meta name="author" content="Reber"/>
  
    
      <title>[转] HTTPS 加密原理简介 | Reber&#39;s Blog</title>
    
  
  <link rel="stylesheet" href="/css/reset.css"/>
  <link rel="stylesheet" href="/css/font.css"/>
  <link rel="stylesheet" href="/css/smigle.css"/>
  
    <link rel="stylesheet" href="/css/monokai-sublime.min.css"/>
  
    <link rel="stylesheet" href="/css/style.css"/>
  
  
    <script src="/js/jquery-3.6.0.min.js"/></script>
  
    <script src="/js/highlight.min.js"/></script>
  
    <script src="/js/style.js"/></script>
  
  <link rel="icon" type="image/img" sizes="16x16" href="/img/logo.png">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
</head>

  <body>
    <header>
  <div id="brand">
    <a class="icon-link" href="https://wyb0.com/">
      <img
        class="icon"
        src="/img/logo.png"
      />
    </a>
    <div class="text">
      <a href="https://wyb0.com/"><h1>Reber&#39;s Blog</h1></a>
      <h3>只会一点点编程、只会一点点渗透</h3>
    </div>
  </div>
  <nav>
    
      
        
        <a href="/"><b>Home</b></a>
      
         | 
        <a href="/posts/"><b>Posts</b></a>
      
         | 
        <a href="/categories/"><b>Categories</b></a>
      
         | 
        <a href="/tags/"><b>Tags</b></a>
      
         | 
        <a href="/about/"><b>About</b></a>
      
         | 
        <a href="/friends/"><b>Friends</b></a>
      
    
  </nav>
  <hr />
</header>

    <div id="content">
      
  <main>
    <article>
      <h1>[转] HTTPS 加密原理简介</h1>
      <div class="post-meta">
  <strong>
    <span>Posted on</span>
    <time>2017-08-01</time>
    <span>in</span>
    
      <a href="/categories/Other">Other</a>
  </strong>
  <span> • 1282 words</span>
  <span> • 3 minute read</span>
  
  
    <div>
      <span>Tags:</span>
      
        <a href="/tags/https">https</a>
    </div>
  
</div>

      <div>

<p>原文链接：<a href="http://www.cnblogs.com/JeffreySun/archive/2010/06/24/1627247.html">http://www.cnblogs.com/JeffreySun/archive/2010/06/24/1627247.html</a></p>

<h3 id="0x00-对称加密与非对称加密">0x00 对称加密与非对称加密</h3>

<ul>
<li>对称加密算法的加密和解密秘钥一样，不区分公钥和私钥，秘钥对外保密.</li>
<li>非对称加密算法的加密秘钥和解密秘钥不一样，公钥加密的内容只能由私钥解密，私钥加密的内容只能由公钥解密，其中私钥保密，公钥公开.</li>
</ul>

<h3 id="0x01-加密通信基本流程">0x01 加密通信基本流程</h3>

<ul>
<li><p>Step1：<br />
客户端&ndash;&gt;服务器：你好</p></li>

<li><p>Step2：<br />
服务器&ndash;&gt;客户端：你好，我是服务器</p></li>

<li><p>Step3：<br />
客户端&ndash;&gt;服务器：向我证明你是服务器</p></li>

<li><p>Step4：<br />
服务器&ndash;&gt;客户端：</p>

<ul>
<li>服务器生成随机字符串string</li>
<li>服务器用自己的私钥加密string，生成密文str</li>
<li>服务器把string和str发送给客户端</li>
</ul></li>

<li><p>Step5：<br />
客户端&ndash;&gt;服务器：</p>

<ul>
<li>客户端收到服务器的数据后，用服务器的公钥解密str，生成string1</li>
<li>客户端将string1和string对比，若一致则说明对方确实是服务器(因为私钥加密后的内容只能由公钥解密，私钥只有服务器持有)</li>
<li>客户端选择一个对称加密算法和一个秘钥，用服务器公钥将他们加密发送给服务器，告诉服务器后续的通信用这个秘钥加密，因为公钥加密的数据只有私钥能解密，所以对称加密的算法和秘钥只有服务器知道</li>
</ul></li>

<li><p>Step6：<br />
服务器&ndash;&gt;客户端：
服务器用私钥解密收到的数据得到对称加密算法及其秘钥</p></li>

<li><p>Step7:<br />
后面客户端和服务器就用对称加密算法进行通信</p></li>
</ul>

<h3 id="0x02-https通信大致原理">0x02 https通信大致原理</h3>

<p>在上面的通信过程中存在一些问题：客户端如何获得公钥？如何确保获得的公钥就是服务器的？<br />
如果黑客生成一对公私钥，然后发给用户的话同样可以完成上述认证流程。<br />
而证书正是为了解决这一问题而存在的，只要改变上面的<strong>Step3</strong>和<strong>Step4</strong>即可引入证书。</p>

<ul>
<li><p>Step1：<br />
客户端&ndash;&gt;服务器：你好</p></li>

<li><p>Step2：<br />
服务器&ndash;&gt;客户端：你好，我是服务器(同时发送证书)</p></li>

<li><p>Step3：<br />
客户端&ndash;&gt;服务端：</p>

<ul>
<li>判断证书是否为服务器的(证书中有服务器的公钥，若证书是服务器的则这个公钥就也是服务器的)</li>
<li>客户端向服务器发送随机生成的字符串string</li>
</ul></li>

<li><p>Step4：<br />
服务端&ndash;&gt;客户端：</p>

<ul>
<li>服务器把string用自己的私钥进行加密，生成str</li>
<li>服务器把str发送给客户端<br /></li>
</ul></li>

<li><p>Step5：<br />
客户端&ndash;&gt;服务器：</p>

<ul>
<li>客户端收到服务器的数据str后，用服务器的公钥解密，生成string1</li>
<li>客户端将string1和string对比，若一致则说明对方确实是服务器(因为私钥加密后的内容只能由公钥解密，私钥只有服务器持有)</li>
<li>客户端选择一个对称加密算法和一个秘钥，用服务器公钥将他们加密发送给服务器，告诉服务器后续的通信用这个秘钥加密，因为公钥加密的数据只有私钥能解密，所以对称加密的算法和秘钥只有服务器知道</li>
</ul></li>

<li><p>Step6：<br />
服务器&ndash;&gt;客户端：
服务器用私钥解密收到的数据得到对称加密算法及其秘钥</p></li>

<li><p>Step7:<br />
后面客户端和服务器就用对称加密算法进行通信</p></li>
</ul>
</div>
    </article>
  </main>

    </div>
    <footer>
  <hr />
  
    <p id="social">
      Find me around the web:
      <br />
      
        
        <a href="https://github.com/reber0?_blank">GitHub</a>
      
         | 
        <a href="https://weibo.com/u/5819760166?_blank">Weibo</a>
      
    </p>
  
  <p class="copyright">
    Copyright © 2015-2022
    <a href="https://wyb0.com/"><strong>Reber</strong></a>.

    Built with
    <a href="http://www.gohugo.io/">Hugo</a>,
    using the theme
    <a href="https://gitlab.com/ian-s-mcb/smigle-hugo-theme">smigle</a>.
  </p>
</footer>

  </body>
</html>
